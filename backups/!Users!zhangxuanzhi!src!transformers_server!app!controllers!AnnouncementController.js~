'use strict';

var AnnouncementLogic = require(appModules.logic.AnnouncementLogic);
var Announcement = require(appModules.models.Announcement);

var AnnouncementController = function() {
    ApplicationController.call(this);
    var self = this;

    this.action('announcement/list', function(req, res, cb) {
       announcementListHandler(req, function(err, respObj) {
           if (err) {
               self.sendErrorResponse(err, res, cb);
               return;
           }
           self.sendSuccessResponse(respObj, res, cb);
           return;
       })
    })
};
util.inherits(AnnouncementController, ApplicationController);

/*
说明: 获取公告列表, 按 sort 属性排序
输入:
输出: 公告列表
*/

function announcementListHandler(req, cb) {
    var gamerObj = req.tf.gamerObj;

    AnnouncementLogic.listAnnouncement(gamerObj, function(err, data) {
        if (err) {
            return cb(err);
        }
        return cb(null, data)
    });
}

var ctr = new AnnouncementController();
exports.routes = {
    POST: {
        '/announcement/list': ctr.action('announcement/list')
    }
};
